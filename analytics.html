<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>DietFlow — Analytics</title>
  <link rel="stylesheet" href="./assets/style.css"/>
</head>

<body>
<header>
  <div class="container nav">
    <div class="brand"><a href="./index.html">dietflow<span>.</span></a></div>
    <div class="links">
      <a href="./recommendations.html">recommendations</a>
      <a href="./plan.html">weekly plan</a>
      <a href="./analytics.html" class="active">analytics</a>
    </div>
  </div>
</header>

<main class="container">
  <div class="sectionTitle">
    <h2>Analytics</h2>
    <div class="hint" id="aHint">Loading charts…</div>
  </div>

  <section class="card">
    <h3 style="margin-bottom:10px;">Calories Distribution (Recommendations)</h3>
    <div id="calHist" style="height:380px;"></div>
  </section>

  <section class="card" style="margin-top:18px;">
    <h3 style="margin-bottom:10px;">Score vs Calories</h3>
    <div id="scoreScatter" style="height:420px;"></div>
  </section>

  <section class="card" style="margin-top:18px;">
    <h3 style="margin-bottom:10px;">Weekly Plan Total Calories</h3>
    <div id="weekBars" style="height:420px;"></div>
  </section>

  <div class="footer">
    Data sources:
    <code id="src1"></code> • <code id="src2"></code>
  </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
<script src="./assets/analytics.js"></script>

<script>
  window.ANALYTICS_REC_CSV =
    "https://raw.githubusercontent.com/iamjahanzaibch/dietflow/main/top_recommendations_lunch.csv";
  window.ANALYTICS_WEEK_CSV =
    "https://raw.githubusercontent.com/iamjahanzaibch/dietflow/main/weekly_plan.csv";

  document.getElementById("src1").textContent = window.ANALYTICS_REC_CSV;
  document.getElementById("src2").textContent = window.ANALYTICS_WEEK_CSV;

  window.initAnalytics().catch(e => {
    document.getElementById("aHint").textContent = "Failed to load analytics.";
  });
</script>
</body>
</html>
